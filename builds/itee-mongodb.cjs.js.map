{"version":3,"file":"itee-mongodb.cjs.js","sources":["../sources/TMongooseController.js","../sources/TMongoDBPlugin.js","../sources/TMongoDBDatabase.js"],"sourcesContent":["/**\n * @author [Tristan Valcke]{@link https://github.com/Itee}\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\n *\n * @class TMongooseController\n * @classdesc The TMongooseController is the base class to perform CRUD operations on the database\n */\n\nimport { TAbstractDataController } from 'itee-database'\nimport {\n    isEmptyArray,\n    isNull,\n    isUndefined\n}                                  from 'itee-validators'\nimport Mongoose                    from 'mongoose'\n\nclass TMongooseController extends TAbstractDataController {\n\n    constructor ( parameters = {} ) {\n\n        const _parameters = {\n            ...{\n                schemaName: ''\n            },\n            ...parameters,\n            ...{\n                driver: Mongoose\n            }\n        }\n\n        super( _parameters )\n\n        this.databaseSchema = this._driver.model( _parameters.schemaName )\n\n    }\n\n    get databaseSchema () {\n\n        return this._databaseSchema\n\n    }\n\n    set databaseSchema ( value ) {\n\n        if ( isNull( value ) ) { throw new TypeError( 'Database schema cannot be null.' ) }\n        if ( isUndefined( value ) ) { throw new TypeError( 'Database schema cannot be undefined.' ) }\n\n        this._databaseSchema = value\n\n    }\n\n    setDatabaseSchema ( value ) {\n\n        this.databaseSchema = value\n        return this\n\n    }\n\n    _createMany ( datas, response ) {\n        super._createMany( datas, response )\n\n        this._databaseSchema.create( datas, this.return( response ) )\n\n    }\n\n    // Create\n    _createOne ( data, response ) {\n        super._createOne( data, response )\n\n        this._databaseSchema.create( data, this.return( response ) )\n\n    }\n\n    _deleteAll ( response ) {\n        super._deleteAll( response )\n\n        this._databaseSchema.collection.drop( TMongooseController.return( response ) )\n\n    }\n\n    _deleteMany ( ids, response ) {\n        super._deleteMany( ids, response )\n\n        this._databaseSchema.deleteMany( { '_id': { $in: ids } }, this.return( response ) )\n\n    }\n\n    // Delete\n    _deleteOne ( id, response ) {\n        super._deleteOne( id, response )\n\n        this._databaseSchema\n            .findByIdAndDelete( id )\n            .then( data => TMongooseController.returnData( data, response ) )\n            .catch( error => TMongooseController.returnError( error, response ) )\n\n    }\n\n    _deleteWhere ( query, response ) {\n        super._deleteWhere( query, response )\n\n        this._databaseSchema.deleteMany( query, this.return( response ) )\n\n    }\n\n    _readAll ( projection, response ) {\n        super._readAll( projection, response )\n\n        this._databaseSchema\n            .find( {}, projection )\n            .lean()\n            .exec()\n            .then( data => TMongooseController.returnData( data, response ) )\n            .catch( error => TMongooseController.returnError( error, response ) )\n\n    }\n\n    _readMany ( ids, projection, response ) {\n        super._readMany( ids, projection, response )\n\n        this._databaseSchema\n            .find( { '_id': { $in: ids } }, projection )\n            .lean()\n            .exec()\n            .then( ( data ) => {\n\n                if ( isNull( data ) || isEmptyArray( data ) ) {\n                    TMongooseController.returnNotFound( response )\n                } else if ( ids.length !== data.length ) {\n                    TMongooseController.returnErrorAndData( {\n                        title:   'Missing data',\n                        message: 'Some requested objects could not be found.'\n                    }, data, response )\n                } else {\n                    TMongooseController.returnData( data, response )\n                }\n\n            } )\n            .catch( error => TMongooseController.returnError( error, response ) )\n\n    }\n\n    // Read\n    _readOne ( id, projection, response ) {\n        super._readOne( id, projection, response )\n\n        this._databaseSchema\n            .findById( id, projection )\n            .lean()\n            .exec()\n            .then( ( data ) => {\n\n                if ( isNull( data ) ) {\n                    TMongooseController.returnNotFound( response )\n                } else {\n                    TMongooseController.returnData( data, response )\n                }\n\n            } )\n            .catch( error => TMongooseController.returnError( error, response ) )\n\n    }\n\n    _readWhere ( query, projection, response ) {\n        super._readWhere( query, projection, response )\n\n        this._databaseSchema\n            .find( query, projection )\n            .lean()\n            .exec()\n            .then( data => TMongooseController.returnData( data, response ) )\n            .catch( error => TMongooseController.returnError( error, response ) )\n\n    }\n\n    _updateAll ( update, response ) {\n        super._updateAll( update, response )\n\n        this._databaseSchema.update( {}, update, { multi: true }, TMongooseController.return( response ) )\n\n    }\n\n    _updateMany ( ids, updates, response ) {\n        super._updateMany( ids, updates, response )\n\n        this._databaseSchema.update( { _id: { $in: ids } }, updates, { multi: true }, TMongooseController.return( response ) )\n\n    }\n\n    // Update\n    _updateOne ( id, update, response ) {\n        super._updateOne( id, update, response )\n\n        this._databaseSchema\n            .findByIdAndUpdate( id, update )\n            .exec()\n            .then( data => TMongooseController.returnData( data, response ) )\n            .catch( error => TMongooseController.returnError( error, response ) )\n\n    }\n\n    _updateWhere ( query, update, response ) {\n        super._updateWhere( query, update, response )\n\n        this._databaseSchema.update( query, update, { multi: true }, TMongooseController.return( response ) )\n\n    }\n\n}\n\nexport { TMongooseController }\n","/**\n * @author [Tristan Valcke]{@link https://github.com/Itee}\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\n *\n * @file Todo\n *\n * @example Todo\n *\n */\n\nimport { TAbstractDatabasePlugin } from 'itee-database'\nimport { getFilesPathsUnder }      from 'itee-utils'\nimport {\n    isEmptyFile,\n    isFunction,\n    isInvalidDirectoryPath\n}                                  from 'itee-validators'\nimport { join }                    from 'path'\n\nclass TMongoDBPlugin extends TAbstractDatabasePlugin {\n\n    constructor ( parameters = {} ) {\n\n        const _parameters = {\n            ...{\n                types:   [],\n                schemas: []\n            },\n            ...parameters\n        }\n\n        super( _parameters )\n\n        this.types   = _parameters.types\n        this.schemas = _parameters.schemas\n\n    }\n\n    get schemas () {\n        return this._schemas\n    }\n\n    set schemas ( value ) {\n        this._schemas = value\n    }\n\n    get types () {\n        return this._types\n    }\n\n    set types ( value ) {\n        this._types = value\n    }\n\n    addSchema ( value ) {\n\n        this._schemas.push( value )\n        return this\n\n    }\n\n    addType ( value ) {\n\n        this._types.push( value )\n        return this\n\n    }\n\n    beforeRegisterRoutes ( Mongoose ) {\n\n        super.beforeRegisterRoutes( Mongoose )\n\n        this._searchLocalTypes()\n        this._registerTypes( Mongoose )\n\n        this._searchLocalSchemas()\n        this._registerSchemas( Mongoose )\n\n    }\n\n    _searchLocalTypes () {\n\n        const typesBasePath = join( this.__dirname, 'types' )\n        if ( isInvalidDirectoryPath( typesBasePath ) ) {\n            this.logger.warn( `Unable to find \"types\" folder for path \"${ typesBasePath }\"` )\n            return\n        } else {\n            this.logger.log( `Add types from: ${ typesBasePath }` )\n        }\n\n        const typesFilesPaths = getFilesPathsUnder( typesBasePath )\n        let typeFilePath      = ''\n        let typeFile          = undefined\n\n        for ( let typeIndex = 0, numberOfTypes = typesFilesPaths.length ; typeIndex < numberOfTypes ; typeIndex++ ) {\n\n            typeFilePath = typesFilesPaths[ typeIndex ]\n            typeFile     = require( typeFilePath )\n            this._types.push( typeFile )\n\n        }\n\n    }\n\n    _registerTypes ( Mongoose ) {\n\n        for ( let type of this._types ) {\n\n            this.logger.log( `Register type: ${ type.name }` )\n            type( Mongoose )\n\n        }\n\n    }\n\n    _searchLocalSchemas () {\n\n        const localSchemasBasePath = join( this.__dirname, 'schemas' )\n        if ( isInvalidDirectoryPath( localSchemasBasePath ) ) {\n            this.logger.warn( `Unable to find \"schemas\" folder for path \"${ localSchemasBasePath }\"` )\n            return\n        } else {\n            this.logger.log( `Add schemas from: ${ localSchemasBasePath }` )\n        }\n\n        const localSchemasFilesPaths = getFilesPathsUnder( localSchemasBasePath )\n        let localSchemaFilePath      = ''\n        let localSchemaFile          = undefined\n        for ( let schemaIndex = 0, numberOfSchemas = localSchemasFilesPaths.length ; schemaIndex < numberOfSchemas ; schemaIndex++ ) {\n\n            localSchemaFilePath = localSchemasFilesPaths[ schemaIndex ]\n\n            if ( isEmptyFile( localSchemaFilePath ) ) {\n\n                this.logger.warn( `Skip empty local database schema: ${ localSchemaFilePath }` )\n                continue\n\n            }\n\n            localSchemaFile = require( localSchemaFilePath )\n            this._schemas.push( localSchemaFile )\n\n        }\n\n    }\n\n    _registerSchemas ( Mongoose ) {\n\n        for ( let schema of this._schemas ) {\n\n            this.logger.log( `Register schema: ${ schema.name }` )\n\n            if ( isFunction( schema.registerModelTo ) ) {\n\n                schema.registerModelTo( Mongoose )\n\n            } else if ( isFunction( schema ) ) {\n\n                schema( Mongoose )\n\n            } else {\n\n                this.logger.error( `Unable to register local database schema: ${ schema }` )\n\n            }\n\n        }\n\n    }\n\n}\n\nexport { TMongoDBPlugin }\n","/**\n * @author [Tristan Valcke]{@link https://github.com/Itee}\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\n *\n * @file Todo\n *\n * @example Todo\n *\n */\n\nimport { TAbstractDatabase } from 'itee-database'\nimport Mongoose              from 'mongoose'\n\nclass TMongoDBDatabase extends TAbstractDatabase {\n\n    constructor ( parameters = {} ) {\n\n        const _parameters = {\n            ...{\n                databaseUrl:     '',\n                databaseOptions: {\n                    useNewUrlParser:    true,\n                    useUnifiedTopology: true\n                }\n            },\n            ...parameters,\n            ...{\n                driver: Mongoose\n            }\n        }\n\n        super( _parameters )\n\n        this.databaseUrl     = _parameters.databaseUrl\n        this.databaseOptions = _parameters.databaseOptions\n\n    }\n\n    close ( onCloseCallback ) {\n\n        this._driver.connection.close( onCloseCallback )\n\n    }\n\n    connect () {\n\n        this._driver\n            .connect( this.databaseUrl, this.databaseOptions )\n            .then( ( info ) => {\n                this.logger.log( info )\n            } )\n            .then( ( /*info*/ ) => {\n                const regex      = /:(\\w*)@/g\n                const matchs     = this.databaseUrl.match( regex )\n                const escapedUrl = ( matchs )\n                    ? this.databaseUrl.replace( matchs[ 0 ], ':*******@' )\n                    : this.databaseUrl\n\n                this.logger.log( `MongoDB at ${ escapedUrl } is connected !` )\n            } )\n            // .then( ( what ) => {\n            //     this.logger.log( `MongoDB at ${ escapedUrl } is connected !` )\n            // } )\n            .catch( ( err ) => {\n                this.logger.error( err )\n            } )\n\n    }\n\n    init () {\n        super.init()\n\n    }\n\n    on ( eventName, callback ) {\n\n        const availableEventNames = [ 'connecting', 'connected', 'open', 'disconnecting', 'disconnected', 'reconnected', 'close', 'error' ]\n\n        if ( availableEventNames.indexOf( eventName ) === -1 ) {\n            return\n        }\n\n        this._driver.connection.on( eventName, callback )\n\n    }\n\n}\n\nexport { TMongoDBDatabase }\n"],"names":["TAbstractDataController","Mongoose","isNull","isUndefined","isEmptyArray","TAbstractDatabasePlugin","join","isInvalidDirectoryPath","getFilesPathsUnder","isEmptyFile","isFunction","TAbstractDatabase"],"mappings":"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"}